<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dajin Lee Weather</title>
    <link rel="stylesheet" type="text/css" href="./style.css">

    <script type="text/javascript">

        function KtoF(kelvin) {
            return Math.round((9 / 5 * kelvin - 459.67) * 100) / 100;
        }

        function camelToNormal(str) {
            var result = str.replace( /([A-Z])/g, " $1" );
            var finalResult = result.charAt(0).toUpperCase() + result.slice(1);
            return finalResult;
        }

        window.onload = function() {

            var xhr = new XMLHttpRequest();
            xhr.open('GET', "http://localhost:3000/weather");
            xhr.responseType = 'json';
            xhr.onload = function() {
                console.log(this.response);
                var weatherInfo = document.getElementById("weatherInfo");
                var text;

                if (this.response && this.response.success) {
                    var res = this.response.payload.currently;

                    console.log(res);
                    for (var key in res) {
                        var info = res[key];

                        var prefix = camelToNormal(key) + ": ";
                        var suffix = "";

                        var infoElement = document.createElement('p');
                        text = document.createTextNode(prefix + info + suffix);
                        infoElement.appendChild(text);
                        weatherInfo.appendChild(infoElement);
                    }
                }else {
                    var err = document.createElement('p');
                    text = document.createTextNode("Ran into an error");
                    err.appendChild(text);
                    weatherInfo.appendChild(err);
                }
            };
            xhr.send();

        }
    </script>
</head>
<body>
    <h1> Philadelphia Weather - by Jin Lee </h1>
    <h4 class="disclaimer"> <a href="https://darksky.net/poweredby/">Powered By Dark Sky</a></h4>
    <hr/>
    <div id="weatherInfo">

    </div>
</body>
</html>